<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mechanics of Defect Evolution Library: GrainBoundary.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="UCLA_LOGO.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mechanics of Defect Evolution Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3f14f6767c31cb4a1d22c13c18cc6fc3.html">model</a></li><li class="navelem"><a class="el" href="dir_59f0d73a86e5fe92219e80dba8dd2fca.html">DislocationDynamics</a></li><li class="navelem"><a class="el" href="dir_a95b7c98fee71e04b016a035f5a4acde.html">Polycrystals</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">GrainBoundary.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_grain_boundary_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* This file is part of MODEL, the Mechanics Of Defect Evolution Library.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2011 by Giacomo Po &lt;gpo@ucla.edu&gt;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * model is distributed without any warranty under the</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * GNU General Public License (GPL) v2 &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef model_GrainBoundary_H_</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define model_GrainBoundary_H_</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span> <span class="comment">// FLT_EPSILON</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;Eigen/Core&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;Eigen/Eigenvalues&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_round_eigen_8h.html">model/Math/RoundEigen.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_simplicial_mesh_8h.html">model/Mesh/SimplicialMesh.h</a>&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_mesh_region_observer_8h.html">model/Mesh/MeshRegionObserver.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_grain_8h.html">model/DislocationDynamics/Polycrystals/Grain.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_grain_boundary_type_8h.html">model/DislocationDynamics/Polycrystals/GrainBoundaryType.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_lattice_plane_8h.html">model/LatticeMath/LatticePlane.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//#include &lt;model/LatticeMath/LineMeshIntersection.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_c_s_l_8h.html">model/LatticeMath/CSL.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_d_s_c_l_8h.html">model/LatticeMath/DSCL.h</a>&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_stress_straight_8h.html">model/DislocationDynamics/ElasticFields/StressStraight.h</a>&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_glide_plane_8h.html">model/DislocationDynamics/GlidePlanes/GlidePlane.h</a>&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="_mesh_plane_8h.html">model/Mesh/MeshPlane.h</a>&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemodel.html">model</a></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    </div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">class </span>GrainBoundary : <span class="keyword">public</span> MeshPlane&lt;dim&gt;,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">/* base            */</span> <span class="keyword">private</span> std::map&lt;int,const Grain&lt;dim&gt;* const&gt;,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">/* base            */</span> <span class="keyword">private</span> std::map&lt;int,const Eigen::Matrix&lt;double,dim,1&gt;&gt;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//    /* base */ private std::map&lt;int,std::shared_ptr&lt;GlidePlane&lt;dim&gt;&gt;&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//        static constexpr int dim=NetworkType::dim;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keyword">enum</span> AxisPlaneRelation{TILT=0,TWIST=1,MIXED=2};</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keyword">typedef</span> MeshRegionBoundary&lt;Simplex&lt;<a class="code" href="bary_search__2d_2plot_search_8m.html#a382f3ca768b275b8d563604f7fc7df73">dim</a>,dim-1&gt; &gt; MeshRegionBoundaryType;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">typedef</span> Eigen::Matrix&lt;long int,dim,1&gt; VectorDimI;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keyword">typedef</span> Eigen::Matrix&lt;  double,dim,1&gt; VectorDimD;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">typedef</span> Eigen::Matrix&lt;double,dim,dim&gt; MatrixDimD;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">typedef</span> LatticeVector&lt;dim&gt; LatticeVectorType;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keyword">typedef</span> ReciprocalLatticeDirection&lt;dim&gt; ReciprocalLatticeDirectionType;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">typedef</span> Grain&lt;dim&gt; GrainType;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keyword">typedef</span> std::map&lt;int,const GrainType* const&gt; GrainContainerType;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">typedef</span> std::map&lt;int,const Eigen::Matrix&lt;double,dim,1&gt;&gt; OutNormalContainerType;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">typedef</span> std::map&lt;int,std::shared_ptr&lt;GlidePlane&lt;dim&gt;&gt;&gt; GlidePlaneContainerType;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">typedef</span> Eigen::Matrix&lt;double,2*dim+1,1&gt; BGkeyType;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">typedef</span> GlidePlane&lt;dim&gt; GlidePlaneType;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        </div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//        static_assert(false,&quot;NEED TO CREATE GLIDE PLANES FOR DSCL AND CSL, AND ADD THEM TO NODES WHICH ARE ON THE GB. THEN ADD THEM TO THE NODES. CAREFUL THAT REMOVE LOOP LINK DO NOT REMOVE THESE GLIDE PLANES&quot;);</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//        static_assert(false,&quot;IN DDVTK SHOW THE MESH FOR THE GBs, and let the GP SHADE THE PLANE&quot;);</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span><span class="comment">//        void storeLatticePlane(GlidePlaneObserver&lt;dim&gt;&amp; dn,</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//                               const SimplicialMesh&lt;dim&gt;&amp; mesh,</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//                               const Grain&lt;dim&gt;&amp; grain,</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//                               const VectorDimD&amp; normal)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//            //std::cout&lt;&lt;&quot;storeLatticePlane&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//            //std::cout&lt;&lt;&quot;normal=&quot;&lt;&lt;normal.transpose()&lt;&lt;std::endl;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//            const ReciprocalLatticeDirectionType R=grain.reciprocalLatticeDirection(normal);</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//            model::cout&lt;&lt;&quot;   GB plane normal for grain &quot;&lt;&lt; grain.grainID&lt;&lt;&quot;:&quot;&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//            model::cout&lt;&lt;&quot;      cartesian components=&quot;&lt;&lt;R.cartesian().normalized().transpose()&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//            model::cout&lt;&lt;&quot;      crystallographic components=&quot;&lt;&lt;grain.rationalApproximation((grain.get_C2G().transpose()*R.cartesian())).transpose()&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span><span class="comment">//            model::cout&lt;&lt;&quot;      interplanar spacing=&quot;&lt;&lt;1.0/R.cartesian().norm()&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span><span class="comment">//            </span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//            const VectorDimD P0=(*regionBoundary.simplices().begin())-&gt;vertexPositionMatrix().col(0); // a point on the plane</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span><span class="comment">//</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//            const auto temp = GlidePlaneContainerType::emplace(std::piecewise_construct,</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//                                                               std::forward_as_tuple(grain.grainID),</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//                                                               std::forward_as_tuple(new GlidePlaneType(&amp;dn,mesh,grain.lattice(),grain.grainID,grain.grainID,P0,normal)));</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//            assert(temp.second);</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//            assert(temp.first-&gt;second-&gt;unitNormal.cross(normal.normalized()).norm()&lt;FLT_EPSILON &amp;&amp; &quot;LatticePlane normal and triangle normal are not the same.&quot;);</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">//            temp.first-&gt;second-&gt;addParentSharedPtr(&amp;temp.first-&gt;second,false,-1); // add shared pointer to GlidePlane</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">//        template&lt;typename NetworkType&gt;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">//        static MeshPlane&lt;dim&gt; getMeshPlane(const MeshRegionBoundaryType&amp; regionBnd)</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">//            //std::cout&lt;&lt;&quot;createLatticePlanes&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span><span class="comment">//            const Simplex&lt;dim,dim-1&gt;&amp; triangle(**regionBnd.begin());</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//            const Simplex&lt;dim,dim&gt;&amp; tet(**triangle.parents().begin());</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">//            const size_t faceID=tet.childOrder(triangle.xID);</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">//            const VectorDimD N=tet.nda.col(faceID);</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">//            const VectorDimD P=triangle.vertexPositionMatrix().col(0);</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">//            MeshPlane&lt;dim&gt; mp(P,N);</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span><span class="comment">//            </span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//            // Check that all tringle vertices are contained by both GB planes</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">//            for(const auto&amp; triangle : regionBnd)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">//                const auto Ps=triangle-&gt;vertexPositionMatrix();</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//                for(int j=0;j&lt;Ps.cols();++j)</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//                                            assert(mp.contains(Ps.col(j)) &amp;&amp; &quot;TRIANGLE VERTEX NOT CONTAINED IN GBPLANE&quot;);</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span><span class="comment">//                }</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//            return mp;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">//        void createLatticePlanes(GlidePlaneObserver&lt;dim&gt;&amp; dn,</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">//                                 const SimplicialMesh&lt;dim&gt;&amp; mesh)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//            //std::cout&lt;&lt;&quot;createLatticePlanes&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">//            GlidePlaneContainerType::clear();</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//            const Simplex&lt;dim,dim-1&gt;&amp; triangle(**regionBoundary.begin());</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">//            for(const auto&amp; tet : triangle.parents())</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">//                const size_t faceID=tet-&gt;childOrder(triangle.xID);</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">//                const VectorDimD outNormal=tet-&gt;nda.col(faceID);</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">//                const double outNorm(outNormal.norm());</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">//                assert(outNorm&gt;FLT_EPSILON &amp;&amp; &quot;Simplex normal has zero norm.&quot;);</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">//                storeLatticePlane(dn,mesh,grain(tet-&gt;region-&gt;regionID),outNormal/outNorm);</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//            assert(glidePlanes().size()==2);</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">//            assert((glidePlanes().begin()-&gt;second-&gt;unitNormal+glidePlanes().rbegin()-&gt;second-&gt;unitNormal).norm()&lt;FLT_EPSILON &amp;&amp; &quot;plane normals are not opposite to each other.&quot;);</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">//            // Check that all tringle vertices are contained by both GB planes</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//            for(const auto&amp; triangle : regionBoundary)</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//                const auto Ps=triangle-&gt;vertexPositionMatrix();</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//                for(int j=0;j&lt;Ps.cols();++j)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//                    for(const auto&amp; grain : grains())</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//                        assert(glidePlane(grain.second-&gt;grainID).contains(Ps.col(j)) &amp;&amp; &quot;TRIANGLE VERTEX NOT CONTAINED IN GBPLANE&quot;);</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">//            if(fabs(_rotationAxis.dot(glidePlanes().begin()-&gt;second-&gt;unitNormal))&lt;FLT_EPSILON)</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">//                model::cout&lt;&lt;&quot;TILT BOUNDARY&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">//                // here check mirror symm equation r=d−2(d⋅n)n to check if symm tilt or asymm tilt</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//            else if(_rotationAxis.cross(glidePlanes().begin()-&gt;second-&gt;unitNormal).norm()&lt;FLT_EPSILON)</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//                model::cout&lt;&lt;&quot;TWIST BOUNDARY&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//            else</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//                model::cout&lt;&lt;&quot;MIXED BOUNDARY&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordtype">void</span> computeCrystallographicRotationAxis()</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">// Compute the relative rotation matrix R such that C2G2=R*C2G1</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keyword">const</span> MatrixDimD <a class="code" href="angle_axis_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a>(<a class="code" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">grain</a>(<a class="code" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">grainBndID</a>.first).get_C2G().transpose()*<a class="code" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">grain</a>(<a class="code" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">grainBndID</a>.second).get_C2G());</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">// Eigen-decompose R</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            Eigen::EigenSolver&lt;MatrixDimD&gt; es(<a class="code" href="angle_axis_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">// Determine _crystallographicRotationAxis as the eigenvector of R corresponding to eigenvalue=1</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0;<a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;<a class="code" href="bary_search__2d_2plot_search_8m.html#a382f3ca768b275b8d563604f7fc7df73">dim</a>;++<a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">if</span>(fabs(es.eigenvalues()(<a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>).real()-1.0)&lt;FLT_EPSILON &amp;&amp; fabs(es.eigenvalues()(<a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>).<a class="code" href="_cubic_spline_intersection_8m.html#ac8505a9cbac04766731d05139fd7dd6e">imag</a>())&lt;FLT_EPSILON)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_cubic_spline_intersection_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>=0;<a class="code" href="_cubic_spline_intersection_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>&lt;<a class="code" href="bary_search__2d_2plot_search_8m.html#a382f3ca768b275b8d563604f7fc7df73">dim</a>;++<a class="code" href="_cubic_spline_intersection_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                        _crystallographicRotationAxis=es.eigenvectors().col(<a class="code" href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>).real();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> axisNorm(_crystallographicRotationAxis.norm());</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            assert(axisNorm&gt;FLT_EPSILON);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            _crystallographicRotationAxis/=axisNorm;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            _rotationAxis=<a class="code" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">grain</a>(<a class="code" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">grainBndID</a>.first).get_C2G()*_crystallographicRotationAxis;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            assert((_rotationAxis-<a class="code" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">grain</a>(<a class="code" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">grainBndID</a>.second).get_C2G()*_crystallographicRotationAxis).norm()&lt;FLT_EPSILON &amp;&amp; <span class="stringliteral">&quot;rotationAxis inconsistency.&quot;</span>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            </div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            cosTheta=0.5*(<a class="code" href="angle_axis_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a>.trace()-1.0);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <a class="code" href="namespacemodel.html#a0ce25fef078a7d9d9cb7cfbabcfbc289">model::cout</a>&lt;&lt;<span class="stringliteral">&quot;   Rotation axis=&quot;</span>&lt;&lt;_crystallographicRotationAxis.transpose()&lt;&lt;std::endl;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="namespacemodel.html#a0ce25fef078a7d9d9cb7cfbabcfbc289">model::cout</a>&lt;&lt;<span class="stringliteral">&quot;   Rotation angle=&quot;</span>&lt;&lt;acos(cosTheta)*180.0/M_PI&lt;&lt;<span class="stringliteral">&quot; deg&quot;</span>&lt;&lt;<a class="code" href="namespacemodel.html#ad88eee7a3e334a4d2f9f676d077527b6">defaultColor</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//        void findGrainBoundaryType(const std::deque&lt;GrainBoundaryType&lt;dim&gt;&gt;&amp; bgTypes)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//            //std::cout&lt;&lt;&quot;findGrainBoundaryType&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//            const VectorDimD n1=(grain(grainBndID.first).get_C2G().transpose()*glidePlane(grainBndID.first).unitNormal).normalized();</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">//            const VectorDimD n2=(grain(grainBndID.second).get_C2G().transpose()*glidePlane(grainBndID.second).unitNormal).normalized();</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//            for (const auto&amp; gbt : bgTypes)</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//                bool axisFound=false;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//                for(const auto&amp; a : gbt.axisPermutations)</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">//                    axisFound=( (_crystallographicRotationAxis-a.normalized()).norm()&lt;FLT_EPSILON ||</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//                               (_crystallographicRotationAxis+a.normalized()).norm()&lt;FLT_EPSILON );</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">//                    if(axisFound)</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">//                        break;</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">//                bool n1Found=false;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">//                for(const auto&amp; n : gbt.n1Permutations)</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">//                    n1Found=( (n1-n.normalized()).norm()&lt;FLT_EPSILON || (n1+n.normalized()).norm()&lt;FLT_EPSILON );</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//                    if(n1Found)</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//                        break;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">//                bool n2Found=false;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//                for(const auto&amp; n : gbt.n2Permutations)</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//                    n2Found=( (n2-n.normalized()).norm()&lt;FLT_EPSILON || (n2+n.normalized()).norm()&lt;FLT_EPSILON );</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//                    if(n2Found)</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">//                        break;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">//                if(!n1Found &amp;&amp; ! n2Found) // search n1 in n2Permutations and viceversa</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">//                    for(const auto&amp; n : gbt.n2Permutations)</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">//                        n1Found=( (n1-n.normalized()).norm()&lt;FLT_EPSILON || (n1+n.normalized()).norm()&lt;FLT_EPSILON );</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">//                        if(n1Found)</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">//                            break;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">//                    </span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">//                    for(const auto&amp; n : gbt.n1Permutations)</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">//                        n2Found=( (n2-n.normalized()).norm()&lt;FLT_EPSILON || (n2+n.normalized()).norm()&lt;FLT_EPSILON );</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">//                        if(n2Found)</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//                            break;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">//                if(axisFound &amp;&amp; n1Found &amp;&amp; n2Found)</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">//                    p_gbType=&amp;gbt;</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">//                    break;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">//            if(p_gbType!=NULL)</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">//                model::cout&lt;&lt;yellowColor&lt;&lt;&quot;   GB type is &quot;&lt;&lt;p_gbType-&gt;name&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">//                model::cout&lt;&lt;yellowColor&lt;&lt;&quot;   GB energy= &quot;&lt;&lt;p_gbType-&gt;energyDensity&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">//                model::cout&lt;&lt;yellowColor&lt;&lt;&quot;   GB dislocation spacing= &quot;&lt;&lt;p_gbType-&gt;dislocationSpacing&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">//                model::cout&lt;&lt;yellowColor&lt;&lt;&quot;   Frank-Bilby dislocation spacing= &quot;&lt;&lt;p_gbType-&gt;FrankBilby_dislocationSpacing&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">//                model::cout&lt;&lt;yellowColor&lt;&lt;&quot;   Read-Shockley_energyDensity= &quot;&lt;&lt;p_gbType-&gt;ReadShockley_energyDensity&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//                //</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">//                //                const double energyDensity;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//                //                const double dislocationSpacing;</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">//            else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">//                assert(0 &amp;&amp; &quot;GRAIN BONUDARY TYPE NOT FOUND.&quot;);</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//            </span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">void</span> populateGBdislocations(std::vector&lt;StressStraight&lt;dim&gt;&gt;&amp; vD, <span class="keyword">const</span> SimplicialMesh&lt;dim&gt;&amp; mesh) <span class="keyword">const</span> __attribute__ ((deprecated))</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">//std::cout&lt;&lt;&quot;populateGBdislocations&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classmodel_1_1_grain_boundary.html#ac9176462cc04b5eafdc3c086ecee873f">use_GBdislocations</a>)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                assert(0 &amp;&amp; <span class="stringliteral">&quot;Re-Enable this&quot;</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//                const int gbRegionID=grainBndID.first;</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">//                const VectorDimD normal=latticePlane(gbRegionID).unitNormal.normalized();</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//                const VectorDimD dir=rotationAxis().normalized();</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">//                const VectorDimD p=dir.cross(latticePlane(gbRegionID).unitNormal).normalized()*grainBoundaryType().dislocationSpacing;</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//                </span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//                model::cout&lt;&lt;&quot;Grain boundary dislocations being added with spacing of &quot;&lt;&lt;grainBoundaryType().dislocationSpacing&lt;&lt;&quot; and along direction &quot;&lt;&lt;p.normalized().transpose()&lt;&lt;std::endl;</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">//                VectorDimD P0(VectorDimD::Zero());</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">//                VectorDimD P1(VectorDimD::Zero());</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">//                assert(mesh.search(P0).first    &amp;&amp;  mesh.search(P1).first &amp;&amp; &quot;Another method is needed to initialize the stress-straight segments if the mesh does not intersect the origin&quot;);</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">//                bool positionOK=true;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">//                int k=-1;</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">//                while(positionOK)</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">//                    k++;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">//                    P0=latticePlane(gbRegionID).P.cartesian()*0-100.0*dir+k*p;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">//                    P1=latticePlane(gbRegionID).P.cartesian()*0+100.0*dir+k*p;</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">//                    LatticeVectorType L0=latticePlane(gbRegionID).snapToLattice(P0);</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">//                    LatticeVectorType L1=latticePlane(gbRegionID).snapToLattice(P1);</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">//                    LatticeDirection&lt;dim&gt; Dir(grain(gbRegionID).latticeDirection(dir));</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">//                    //The original points have to first be within the mesh!!</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">//                    if(  mesh.search(L0.cartesian()+Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">//                       mesh.search(L0.cartesian()-Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">//                       mesh.search(L1.cartesian()+Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">//                       mesh.search(L1.cartesian()-Dir.cartesian()).first      )</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//                        //Determine the dislocation line - mesh intersection at either end of the projected dislocation position, and snap positions to that lattice point.</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">//                        LatticeVectorType L0=latticePlane(gbRegionID).snapToLattice(P0);</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">//                        LatticeVectorType L1=latticePlane(gbRegionID).snapToLattice(P1);</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//                        </span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">//                        LatticeLine line(L0,Dir);</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">//                        LineMeshIntersection lmi(line,L0+Dir,mesh,mesh.search(P0).second);</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">//                        LatticeDirection&lt;dim&gt; negativeDir(grain(gbRegionID).latticeDirection((-1.0)*dir));</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">//                        LatticeLine line2(L0,negativeDir);</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">//                        LineMeshIntersection lmi2(line2,L0-Dir,mesh,mesh.search(P0).second);</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">//                        //</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">//                        if(  mesh.search(lmi.L.cartesian()).second-&gt;region-&gt;regionID==gbRegionID  &amp;&amp;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">//                           mesh.search(lmi2.L.cartesian()).second-&gt;region-&gt;regionID==gbRegionID)</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">//                            vD.emplace_back(lmi.L.cartesian(),lmi2.L.cartesian(),grainBoundaryType().Burgers*normal);</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">//                        else</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">//                            positionOK=false;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">//                k=0;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">//                while(positionOK)</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">//                    k++;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//                    P0=latticePlane(gbRegionID).P.cartesian()*0-1.0*dir-k*p;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">//                    P1=latticePlane(gbRegionID).P.cartesian()*0+1.0*dir-k*p;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">//                    LatticeVectorType L0=latticePlane(gbRegionID).snapToLattice(P0);</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">//                    LatticeVectorType L1=latticePlane(gbRegionID).snapToLattice(P1);</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">//                    LatticeDirection&lt;dim&gt; Dir(grain(gbRegionID).latticeDirection(dir));</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">//                    //The original points have to first be within the mesh!!</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">//                    if(  mesh.search(L0.cartesian()+Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//                       mesh.search(L0.cartesian()-Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">//                       mesh.search(L1.cartesian()+Dir.cartesian()).first    &amp;&amp;</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">//                       mesh.search(L1.cartesian()-Dir.cartesian()).first      )</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">//                    {</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">//                        //Determine the dislocation line - mesh intersection at either end of the projected dislocation position, and snap positions to that lattice point.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">//                        LatticeVectorType L0=latticePlane(gbRegionID).snapToLattice(P0);</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">//                        LatticeVectorType L1=latticePlane(gbRegionID).snapToLattice(P1);</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">//                        </span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">//                        LatticeLine line(L0,Dir);</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//                        LineMeshIntersection lmi(line,L0+Dir,mesh,mesh.search(P0).second);</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//                        LatticeDirection&lt;dim&gt; negativeDir(grain(gbRegionID).latticeDirection((-1.0)*dir));</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//                        LatticeLine line2(L0,negativeDir);</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">//                        LineMeshIntersection lmi2(line2,L0-Dir,mesh,mesh.search(P0).second);</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">//                        //</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">//                        if(  mesh.search(lmi.L.cartesian()).second-&gt;region-&gt;regionID==gbRegionID  &amp;&amp;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">//                           mesh.search(lmi2.L.cartesian()).second-&gt;region-&gt;regionID==gbRegionID)</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">//                            vD.emplace_back(lmi.L.cartesian(),lmi2.L.cartesian(),grainBoundaryType().Burgers*normal);</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">//                        else</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">//                        {</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">//                            </span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">//                            positionOK=false;</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">//                        }</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        </div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">//        CSL&lt;dim&gt; _csl;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">//        DSCL&lt;dim&gt; _dscl;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        VectorDimD _crystallographicRotationAxis;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        VectorDimD _rotationAxis;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordtype">double</span> cosTheta; <span class="comment">// cosine of relative rotation angle between grains</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keyword">const</span> GrainBoundaryType&lt;dim&gt;* p_gbType;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        </div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#ac9176462cc04b5eafdc3c086ecee873f">  469</a></span>&#160;        <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classmodel_1_1_grain_boundary.html#ac9176462cc04b5eafdc3c086ecee873f">use_GBdislocations</a>;</div><div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#aa204a2cb7b41533927cbd57d8aea91f1">  470</a></span>&#160;        <span class="keyword">const</span> MeshRegionBoundaryType&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#aa204a2cb7b41533927cbd57d8aea91f1">regionBoundary</a>;</div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">  471</a></span>&#160;        <span class="keyword">const</span> std::pair&lt;int,int&gt;&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">grainBndID</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">//        template&lt;typename NetworkType&gt;</span></div><div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#ab9bb967df03a901c74af028deafa756c">  476</a></span>&#160;        <a class="code" href="classmodel_1_1_grain_boundary.html#ab9bb967df03a901c74af028deafa756c">GrainBoundary</a>(<span class="keyword">const</span> MeshRegionBoundaryType&amp; regionbnd_in,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                      <a class="code" href="classmodel_1_1_grain.html">Grain&lt;dim&gt;</a>&amp; grainFirst,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                      <a class="code" href="classmodel_1_1_grain.html">Grain&lt;dim&gt;</a>&amp; grainSecond,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                      <a class="code" href="structmodel_1_1_glide_plane_observer.html">GlidePlaneObserver&lt;dim&gt;</a>&amp; dn,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                      <span class="keyword">const</span> <a class="code" href="structmodel_1_1_simplicial_mesh.html">SimplicialMesh&lt;dim&gt;</a>&amp; mesh) :</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">//        /* init */ MeshPlane&lt;dim&gt;(getMeshPlane(regionbnd_in)),</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">/* init */</span> <a class="code" href="structmodel_1_1_mesh_plane.html">MeshPlane</a>&lt;dim&gt;(mesh,grainFirst.grainID,grainSecond.grainID),</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">//        /* init */ _csl(grainFirst,grainSecond),</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">//        /* init */ _dscl(grainFirst,grainSecond),</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">/* init */</span> _crystallographicRotationAxis(VectorDimD::Zero()),</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">/* init */</span> _rotationAxis(_crystallographicRotationAxis),</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">/* init */</span> cosTheta(1.0),</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">/* init */</span> p_gbType(NULL),</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">/* init */</span> regionBoundary(regionbnd_in),</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">/* init */</span> grainBndID(regionBoundary.regionBndID)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <a class="code" href="namespacemodel.html#a0ce25fef078a7d9d9cb7cfbabcfbc289">model::cout</a>&lt;&lt;<a class="code" href="namespacemodel.html#ac930beb7c72e614bae7e16edd2a1738a">greenBoldColor</a>&lt;&lt;<span class="stringliteral">&quot;Creating GrainBoundary (&quot;</span>&lt;&lt;grainBndID.first&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;grainBndID.second&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>&lt;&lt;<a class="code" href="namespacemodel.html#ad88eee7a3e334a4d2f9f676d077527b6">defaultColor</a>&lt;&lt;std::endl;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">//            model::cout&lt;&lt;defaultColor&lt;&lt;&quot;   CSL:  sigma= &quot;&lt;&lt;_csl.sigma()&lt;&lt;std::endl;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">//            model::cout&lt;&lt;defaultColor&lt;&lt;&quot;   DSCL: sigma= &quot;&lt;&lt;_dscl.sigma()&lt;&lt;std::endl;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="comment">// Populate pointers to parent Grains</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            GrainContainerType::emplace(grainFirst.<a class="code" href="classmodel_1_1_grain.html#a2a85e57eb7d6c771735123d577f06bee">grainID</a>,&amp;grainFirst);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            GrainContainerType::emplace(grainSecond.<a class="code" href="classmodel_1_1_grain.html#a2a85e57eb7d6c771735123d577f06bee">grainID</a>,&amp;grainSecond);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="comment">// Populate outNormals to grains</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmodel_1_1_simplex.html">Simplex</a>&lt;<a class="code" href="bary_search__2d_2plot_search_8m.html#a382f3ca768b275b8d563604f7fc7df73">dim</a>,dim-1&gt;&amp; triangle(**regionBoundary.begin());</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tet : triangle.parents())</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">size_t</span> faceID=tet-&gt;<a class="code" href="classmodel_1_1_simplex.html#a73e18df8209fd8be497767090a102e69">childOrder</a>(triangle.xID);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keyword">const</span> VectorDimD <a class="code" href="classmodel_1_1_grain_boundary.html#aaae72af1d2f57739499df6fd6d4b81a1">outNormal</a>=tet-&gt;nda.col(faceID);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> outNorm(outNormal.norm());</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> rID=tet-&gt;region-&gt;regionID;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                assert(outNorm&gt;FLT_EPSILON &amp;&amp; <span class="stringliteral">&quot;Simplex normal has zero norm.&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                assert(rID==grainFirst.<a class="code" href="classmodel_1_1_grain.html#a2a85e57eb7d6c771735123d577f06bee">grainID</a> || rID==grainSecond.<a class="code" href="classmodel_1_1_grain.html#a2a85e57eb7d6c771735123d577f06bee">grainID</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                OutNormalContainerType::emplace(rID,outNormal/outNorm);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="comment">// Initialize</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <a class="code" href="classmodel_1_1_grain_boundary.html#ae3eecee04d38528294f077cf142e2693">initializeGrainBoundary</a>(dn,mesh);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            grainFirst.emplace(grainBndID,<span class="keyword">this</span>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            grainSecond.emplace(grainBndID,<span class="keyword">this</span>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a5bbc95080a889973bb4458d37518537f">  521</a></span>&#160;        <span class="keyword">const</span> GrainContainerType&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#a5bbc95080a889973bb4458d37518537f">grains</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">  527</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="classmodel_1_1_grain.html">Grain&lt;dim&gt;</a>&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">grain</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="_longest_processing_time_8m.html#a5d2aad4440da75aa43f2643e72b1a3bd">k</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">return</span> *(<a class="code" href="classmodel_1_1_grain_boundary.html#a5bbc95080a889973bb4458d37518537f">grains</a>().at(k));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a4d5a520fa89200fc13fc25ba75ce7b47">  533</a></span>&#160;        <span class="keyword">const</span> OutNormalContainerType&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#a4d5a520fa89200fc13fc25ba75ce7b47">outNormals</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        </div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#aaae72af1d2f57739499df6fd6d4b81a1">  538</a></span>&#160;        <span class="keyword">const</span> VectorDimD&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#aaae72af1d2f57739499df6fd6d4b81a1">outNormal</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="_longest_processing_time_8m.html#a5d2aad4440da75aa43f2643e72b1a3bd">k</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classmodel_1_1_grain_boundary.html#a4d5a520fa89200fc13fc25ba75ce7b47">outNormals</a>().at(k);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">//        const GlidePlaneContainerType&amp; glidePlanes() const</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//            return *this;</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">//        const GlidePlaneType&amp; glidePlane(const int&amp; k) const</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">//            return *glidePlanes().at(k).get();</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//        template&lt;typename NetworkType&gt;</span></div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#ae3eecee04d38528294f077cf142e2693">  557</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classmodel_1_1_grain_boundary.html#ae3eecee04d38528294f077cf142e2693">initializeGrainBoundary</a>(<a class="code" href="structmodel_1_1_glide_plane_observer.html">GlidePlaneObserver&lt;dim&gt;</a>&amp; dn,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="structmodel_1_1_simplicial_mesh.html">SimplicialMesh&lt;dim&gt;</a>&amp; mesh)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">//            model::cout&lt;&lt;yellowColor&lt;&lt;&quot;GrainBoundary (&quot;&lt;&lt;grainBndID.first&lt;&lt;&quot; &quot;&lt;&lt;grainBndID.second&lt;&lt;&quot;)&quot;&lt;&lt;defaultColor&lt;&lt;std::endl;</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">//            _csl.update(true);</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">//            _dscl.update(true);</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            computeCrystallographicRotationAxis();</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">//            createLatticePlanes(dn,mesh);</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">//            findGrainBoundaryType(poly.grainBoundaryTypes());</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">//            populateGBdislocations(dn.poly.grainBoundaryDislocations(),dn.poly.mesh);</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            </div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment">//                grain(gb.first.second).emplace(gb.first,&amp;gb.second);</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a5cfe21175394c23a65f04de5a87347a2">  572</a></span>&#160;        <span class="keyword">const</span> VectorDimD&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#a5cfe21175394c23a65f04de5a87347a2">crystallographicRotationAxis</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">return</span> _crystallographicRotationAxis;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        </div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#aef89ae1f7e810fedc1c4cc71090ef958">  578</a></span>&#160;        <span class="keyword">const</span> VectorDimD&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#aef89ae1f7e810fedc1c4cc71090ef958">rotationAxis</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">return</span> _rotationAxis;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a0c9d653585c8cdd020cfd6bd87776712">  584</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classmodel_1_1_grain_boundary.html#a0c9d653585c8cdd020cfd6bd87776712">rotationAngle</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">return</span> acos(cosTheta);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a27b08c6be7d163196c1856a6efd7d300">  590</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="classmodel_1_1_grain_boundary_type.html">GrainBoundaryType&lt;dim&gt;</a>&amp; <a class="code" href="classmodel_1_1_grain_boundary.html#a27b08c6be7d163196c1856a6efd7d300">grainBoundaryType</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="keywordflow">return</span> *p_gbType;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">//        const CSL&lt;dim&gt;&amp; csl() const</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">//            return _csl;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">//        </span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">//        const DSCL&lt;dim&gt;&amp; dscl() const</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">//            return _dscl;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">/**********************************************************************/</span></div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classmodel_1_1_grain_boundary.html#a79715e1eef5dc5838bceb850a075ed57">  608</a></span>&#160;        std::string <a class="code" href="classmodel_1_1_grain_boundary.html#a79715e1eef5dc5838bceb850a075ed57">tag</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keyword">        </span>{</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;(&quot;</span> + std::to_string(grainBndID.first)+<span class="stringliteral">&quot;,&quot;</span> +std::to_string(grainBndID.second)+<span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    };</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmodel_1_1_grain_boundary.html">GrainBoundary&lt;dim&gt;::use_GBdislocations</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    </div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;} <span class="comment">// end namespace</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="comment">//        /**********************************************************************/</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <span class="comment">//        void populateGBdislocations(std::vector&lt;StressStraight&lt;dim&gt;&gt;&amp; vD) const</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="comment">//        {</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="comment">//            if(use_GBdislocations)</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="comment">//            {</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="comment">//            const VectorDimD dir=rotationAxis().normalized();</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="comment">//            const VectorDimD p=dir.cross(latticePlane(grainBndID.first).unitNormal).normalized()*grainBoundaryType().dislocationSpacing;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="comment">//            VectorDimD P0(VectorDimD::Zero());</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="comment">//            VectorDimD P1(VectorDimD::Zero());</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="comment">//            VectorDimD Q(latticePlane(grainBndID.first).P.cartesian());</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <span class="comment">//            Q(1)=0.0;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="comment">//            for(int k=0;k&lt;10;++k)</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="comment">//            {</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="comment">//                P0=Q-100.0*dir+k*p;</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="comment">//                P1=Q+100.0*dir+k*p;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="comment">//                //std::cout&lt;&lt;&quot;GB DISLOCATIONS MAY BE WRONG SIGN&quot;&lt;&lt;std::endl;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="comment">//                vD.emplace_back(P0,P1,grainBoundaryType().Burgers*latticePlane(grainBndID.first).unitNormal.normalized());</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="comment">//            }</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="comment">//            }</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="comment">//        }</span></div><div class="ttc" id="_simplicial_mesh_8h_html"><div class="ttname"><a href="_simplicial_mesh_8h.html">SimplicialMesh.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a79715e1eef5dc5838bceb850a075ed57"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a79715e1eef5dc5838bceb850a075ed57">model::GrainBoundary::tag</a></div><div class="ttdeci">std::string tag() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00608">GrainBoundary.h:608</a></div></div>
<div class="ttc" id="_round_eigen_8h_html"><div class="ttname"><a href="_round_eigen_8h.html">RoundEigen.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a5bbc95080a889973bb4458d37518537f"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a5bbc95080a889973bb4458d37518537f">model::GrainBoundary::grains</a></div><div class="ttdeci">const GrainContainerType &amp; grains() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00521">GrainBoundary.h:521</a></div></div>
<div class="ttc" id="structmodel_1_1_glide_plane_observer_html"><div class="ttname"><a href="structmodel_1_1_glide_plane_observer.html">model::GlidePlaneObserver</a></div><div class="ttdef"><b>Definition:</b> <a href="_glide_plane_observer_8h_source.html#l00037">GlidePlaneObserver.h:37</a></div></div>
<div class="ttc" id="classmodel_1_1_simplex_html"><div class="ttname"><a href="classmodel_1_1_simplex.html">model::Simplex</a></div><div class="ttdef"><b>Definition:</b> <a href="_simplex_8h_source.html#l00087">Simplex.h:87</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a0c9d653585c8cdd020cfd6bd87776712"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a0c9d653585c8cdd020cfd6bd87776712">model::GrainBoundary::rotationAngle</a></div><div class="ttdeci">double rotationAngle() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00584">GrainBoundary.h:584</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_type_html"><div class="ttname"><a href="classmodel_1_1_grain_boundary_type.html">model::GrainBoundaryType</a></div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_type_8h_source.html#l00027">GrainBoundaryType.h:27</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a8d909ae84c0450d316bfe5c4183fba09"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a8d909ae84c0450d316bfe5c4183fba09">model::GrainBoundary::grain</a></div><div class="ttdeci">const Grain&lt; dim &gt; &amp; grain(const int &amp;k) const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00527">GrainBoundary.h:527</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_ae3eecee04d38528294f077cf142e2693"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#ae3eecee04d38528294f077cf142e2693">model::GrainBoundary::initializeGrainBoundary</a></div><div class="ttdeci">void initializeGrainBoundary(GlidePlaneObserver&lt; dim &gt; &amp;dn, const SimplicialMesh&lt; dim &gt; &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00557">GrainBoundary.h:557</a></div></div>
<div class="ttc" id="_lattice_plane_8h_html"><div class="ttname"><a href="_lattice_plane_8h.html">LatticePlane.h</a></div></div>
<div class="ttc" id="_cubic_spline_intersection_8m_html_a1aabac6d068eef6a7bad3fdf50a05cc8"><div class="ttname"><a href="_cubic_spline_intersection_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a></div><div class="ttdeci">d</div><div class="ttdef"><b>Definition:</b> <a href="_cubic_spline_intersection_8m_source.html#l00091">CubicSplineIntersection.m:91</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_ac9176462cc04b5eafdc3c086ecee873f"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#ac9176462cc04b5eafdc3c086ecee873f">model::GrainBoundary::use_GBdislocations</a></div><div class="ttdeci">static bool use_GBdislocations</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00469">GrainBoundary.h:469</a></div></div>
<div class="ttc" id="namespacemodel_html"><div class="ttname"><a href="namespacemodel.html">model</a></div><div class="ttdef"><b>Definition:</b> <a href="_d_d__converter_8dox_source.html#l00001">DD_converter.dox:1</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_aa204a2cb7b41533927cbd57d8aea91f1"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#aa204a2cb7b41533927cbd57d8aea91f1">model::GrainBoundary::regionBoundary</a></div><div class="ttdeci">const MeshRegionBoundaryType &amp; regionBoundary</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00470">GrainBoundary.h:470</a></div></div>
<div class="ttc" id="_d_s_c_l_8h_html"><div class="ttname"><a href="_d_s_c_l_8h.html">DSCL.h</a></div></div>
<div class="ttc" id="test_2bary_search__2d_2write_mesh2d_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="test_2bary_search__2d_2write_mesh2d_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition:</b> <a href="test_2bary_search__2d_2write_mesh2d_8m_source.html#l00023">test/barySearch_2d/writeMesh2d.m:23</a></div></div>
<div class="ttc" id="_grain_8h_html"><div class="ttname"><a href="_grain_8h.html">Grain.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_html_a2a85e57eb7d6c771735123d577f06bee"><div class="ttname"><a href="classmodel_1_1_grain.html#a2a85e57eb7d6c771735123d577f06bee">model::Grain::grainID</a></div><div class="ttdeci">const int &amp; grainID</div><div class="ttdef"><b>Definition:</b> <a href="_grain_8h_source.html#l00105">Grain.h:105</a></div></div>
<div class="ttc" id="_stress_straight_8h_html"><div class="ttname"><a href="_stress_straight_8h.html">StressStraight.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a5cfe21175394c23a65f04de5a87347a2"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a5cfe21175394c23a65f04de5a87347a2">model::GrainBoundary::crystallographicRotationAxis</a></div><div class="ttdeci">const VectorDimD &amp; crystallographicRotationAxis() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00572">GrainBoundary.h:572</a></div></div>
<div class="ttc" id="_cubic_spline_intersection_8m_html_ac8505a9cbac04766731d05139fd7dd6e"><div class="ttname"><a href="_cubic_spline_intersection_8m.html#ac8505a9cbac04766731d05139fd7dd6e">imag</a></div><div class="ttdeci">imag(t)</div></div>
<div class="ttc" id="structmodel_1_1_simplicial_mesh_html"><div class="ttname"><a href="structmodel_1_1_simplicial_mesh.html">model::SimplicialMesh&lt; dim &gt;</a></div></div>
<div class="ttc" id="structmodel_1_1_mesh_plane_html"><div class="ttname"><a href="structmodel_1_1_mesh_plane.html">model::MeshPlane</a></div><div class="ttdef"><b>Definition:</b> <a href="_mesh_plane_8h_source.html#l00025">MeshPlane.h:25</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a4d5a520fa89200fc13fc25ba75ce7b47"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a4d5a520fa89200fc13fc25ba75ce7b47">model::GrainBoundary::outNormals</a></div><div class="ttdeci">const OutNormalContainerType &amp; outNormals() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00533">GrainBoundary.h:533</a></div></div>
<div class="ttc" id="_longest_processing_time_8m_html_a5d2aad4440da75aa43f2643e72b1a3bd"><div class="ttname"><a href="_longest_processing_time_8m.html#a5d2aad4440da75aa43f2643e72b1a3bd">k</a></div><div class="ttdeci">for k</div><div class="ttdef"><b>Definition:</b> <a href="_longest_processing_time_8m_source.html#l00020">LongestProcessingTime.m:20</a></div></div>
<div class="ttc" id="_mesh_plane_8h_html"><div class="ttname"><a href="_mesh_plane_8h.html">MeshPlane.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_aaae72af1d2f57739499df6fd6d4b81a1"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#aaae72af1d2f57739499df6fd6d4b81a1">model::GrainBoundary::outNormal</a></div><div class="ttdeci">const VectorDimD &amp; outNormal(const int &amp;k) const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00538">GrainBoundary.h:538</a></div></div>
<div class="ttc" id="_c_s_l_8h_html"><div class="ttname"><a href="_c_s_l_8h.html">CSL.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_html"><div class="ttname"><a href="classmodel_1_1_grain.html">model::Grain</a></div><div class="ttdef"><b>Definition:</b> <a href="_grain_8h_source.html#l00031">Grain.h:31</a></div></div>
<div class="ttc" id="classmodel_1_1_simplex_html_a73e18df8209fd8be497767090a102e69"><div class="ttname"><a href="classmodel_1_1_simplex.html#a73e18df8209fd8be497767090a102e69">model::Simplex::childOrder</a></div><div class="ttdeci">size_t childOrder(const ChildIDType &amp;childID) const</div><div class="ttdef"><b>Definition:</b> <a href="_simplex_8h_source.html#l00180">Simplex.h:180</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_a27b08c6be7d163196c1856a6efd7d300"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#a27b08c6be7d163196c1856a6efd7d300">model::GrainBoundary::grainBoundaryType</a></div><div class="ttdeci">const GrainBoundaryType&lt; dim &gt; &amp; grainBoundaryType() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00590">GrainBoundary.h:590</a></div></div>
<div class="ttc" id="angle_axis_8m_html_acb95449a94688af33f6e9bb090cf2936"><div class="ttname"><a href="angle_axis_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a></div><div class="ttdeci">function R</div><div class="ttdef"><b>Definition:</b> <a href="angle_axis_8m_source.html#l00001">angleAxis.m:1</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_ab9bb967df03a901c74af028deafa756c"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#ab9bb967df03a901c74af028deafa756c">model::GrainBoundary::GrainBoundary</a></div><div class="ttdeci">GrainBoundary(const MeshRegionBoundaryType &amp;regionbnd_in, Grain&lt; dim &gt; &amp;grainFirst, Grain&lt; dim &gt; &amp;grainSecond, GlidePlaneObserver&lt; dim &gt; &amp;dn, const SimplicialMesh&lt; dim &gt; &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00476">GrainBoundary.h:476</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_ab68fbec345623435455a9e37df8aa9d5"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#ab68fbec345623435455a9e37df8aa9d5">model::GrainBoundary::grainBndID</a></div><div class="ttdeci">const std::pair&lt; int, int &gt; &amp; grainBndID</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00471">GrainBoundary.h:471</a></div></div>
<div class="ttc" id="namespacemodel_html_ad88eee7a3e334a4d2f9f676d077527b6"><div class="ttname"><a href="namespacemodel.html#ad88eee7a3e334a4d2f9f676d077527b6">model::defaultColor</a></div><div class="ttdeci">std::string defaultColor</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_colors_8h_source.html#l00021">TerminalColors.h:21</a></div></div>
<div class="ttc" id="bary_search__2d_2plot_search_8m_html_a382f3ca768b275b8d563604f7fc7df73"><div class="ttname"><a href="bary_search__2d_2plot_search_8m.html#a382f3ca768b275b8d563604f7fc7df73">dim</a></div><div class="ttdeci">close all clear all clc dim</div><div class="ttdef"><b>Definition:</b> <a href="bary_search__2d_2plot_search_8m_source.html#l00005">barySearch_2d/plotSearch.m:5</a></div></div>
<div class="ttc" id="_mesh_region_observer_8h_html"><div class="ttname"><a href="_mesh_region_observer_8h.html">MeshRegionObserver.h</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html">model::GrainBoundary</a></div><div class="ttdef"><b>Definition:</b> <a href="_grain_8h_source.html#l00028">Grain.h:28</a></div></div>
<div class="ttc" id="_grain_boundary_type_8h_html"><div class="ttname"><a href="_grain_boundary_type_8h.html">GrainBoundaryType.h</a></div></div>
<div class="ttc" id="_glide_plane_8h_html"><div class="ttname"><a href="_glide_plane_8h.html">GlidePlane.h</a></div></div>
<div class="ttc" id="namespacemodel_html_ac930beb7c72e614bae7e16edd2a1738a"><div class="ttname"><a href="namespacemodel.html#ac930beb7c72e614bae7e16edd2a1738a">model::greenBoldColor</a></div><div class="ttdeci">std::string greenBoldColor</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_colors_8h_source.html#l00027">TerminalColors.h:27</a></div></div>
<div class="ttc" id="classmodel_1_1_grain_boundary_html_aef89ae1f7e810fedc1c4cc71090ef958"><div class="ttname"><a href="classmodel_1_1_grain_boundary.html#aef89ae1f7e810fedc1c4cc71090ef958">model::GrainBoundary::rotationAxis</a></div><div class="ttdeci">const VectorDimD &amp; rotationAxis() const</div><div class="ttdef"><b>Definition:</b> <a href="_grain_boundary_8h_source.html#l00578">GrainBoundary.h:578</a></div></div>
<div class="ttc" id="namespacemodel_html_a0ce25fef078a7d9d9cb7cfbabcfbc289"><div class="ttname"><a href="namespacemodel.html#a0ce25fef078a7d9d9cb7cfbabcfbc289">model::cout</a></div><div class="ttdeci">MPIcout cout</div><div class="ttdef"><b>Definition:</b> <a href="_m_p_icout_8h_source.html#l00092">MPIcout.h:92</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 30 2018 00:13:12 for Mechanics of Defect Evolution Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
